// Copyright (c) 2012 Florian Hartmann, https://github.com/florian https://github.com/florian/lostorage.js
!function(a,b){var c={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},isPlainObj:function(a){return a===Object(a)},toArray:function(a){return Array.prototype.slice.call(a)},prepareArgs:function(a,b){return a=c.toArray(a),a.unshift(b),a},getObjKeyByValue:function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c},prepareReturn:function(b){return a[c.getObjKeyByValue(g,b)]},retrieve:function(a,b){return null==a?b:a},serialize:function(a){return JSON.stringify(a)},unserialize:function(a){return null==a?b:JSON.parse(a)}},d=function(){return d.get.apply(this,arguments)},e={storage:function(){return storage.get.apply(storage,arguments)},session:function(){return session.get.apply(session,arguments)}};d.set=function(a,b,d){if(c.isPlainObj(b))for(var e in b)b.hasOwnProperty(e)&&a.setItem(e,c.serialize(b[e]));else a.setItem(b,c.serialize(d));return c.prepareReturn(a)},d.invert=function(a,b){return this.set(a,b,!this.get(a,b))},d.add=function(a,b,c){return this.set(a,b,this.get(a,b)+parseInt(c,10))},d.increase=function(a,b,d){return this.add(a,b,c.retrieve(d,1))},d.decrease=function(a,b,d){return this.add(a,b,-c.retrieve(d,1))},d.concat=function(a,b,c){return this.set(a,b,this.get(a,b)+c)},d.push=function(a,b,d){var e=c.toArray(arguments),f=this.get(a,b,[]);return e.splice(0,2),f.push.apply(f,e),this.set(a,b,f)},d.extend=function(a,b,d,e){var f=this.get(a,b,{});if(c.isPlainObj(d))for(var g in d)d.hasOwnProperty(g)&&(f[g]=d[g]);else f[d]=e;return this.set(a,b,f)},d.remove=function(a,b){b=c.isArray(b)?b:c.toArray(arguments);for(var d=0,e=b.length;e>d;d++)delete a[b[d]];return c.prepareReturn(a)},d.empty=function(a){return a.clear(),c.prepareReturn(a)},d.get=function(a,d,e){if(e=e||b,c.isArray(d)){for(var f={},g=0,h=d.length;h>g;g++){var i=d[g];f[i]=this.get(a,i,e)}return f}return c.retrieve(c.unserialize(a.getItem(d)),e)},d.all=function(a){for(var b={},d=0,e=a.length;e>d;d++){var f=a.key(d);b[f]=c.unserialize(a.getItem(f))}return b};for(var f="set invert add increase decrease concat push extend remove empty get all".split(" "),g={storage:localStorage,session:sessionStorage},h=0,i=f.length;i>h;h++){var j=f[h];for(var k in g)if(g.hasOwnProperty(k)){var l=g[k];e[k][j]=function(a,b){return function(){var e=c.prepareArgs(arguments,b);return d[a].apply(d,e)}}(j,l)}}var m={storage:e.storage,session:e.session};"function"==typeof define&&define.amd?define(function(){return m}):"undefined"!=typeof exports?module.exports=m:(a.storage=e.storage,a.session=e.session)}(window);