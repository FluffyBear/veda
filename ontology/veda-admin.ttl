# baseURI: http://semantic-machines.com/veda/veda-admin
# imports: http://semantic-machines.com/veda/veda-schema
# imports: http://www.w3.org/1999/02/22-rdf-syntax-ns#
# imports: http://www.w3.org/2000/01/rdf-schema#
# imports: http://www.w3.org/2002/07/owl

# c14n-version: 3
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix veda-admin: <http://semantic-machines.com/veda/veda-admin/> .
@prefix veda-schema: <http://semantic-machines.com/veda/veda-schema/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
<http://semantic-machines.com/veda/veda-admin>
  rdf:type owl:Ontology ;
  rdfs:label "Veda system administrator ontology"@en ;
  rdfs:label "Онтология администратора системы Веда"@ru ;
  owl:imports <http://semantic-machines.com/veda/veda-schema> ;
  owl:imports rdf: ;
  owl:imports rdfs: ;
  owl:imports <http://www.w3.org/2002/07/owl> ;
  owl:versionInfo "1.0" ;
.
veda-admin:VedaSystem
  rdf:type veda-schema:Person ;
  veda-schema:actualVersion veda-schema:VedaSystem ;
  veda-schema:birthday "2014-03-05"^^xsd:date ;
  veda-schema:firstName "Veda"@en ;
  veda-schema:firstName "Веда"@ru ;
  veda-schema:hasAccount veda-schema:VedaSystemAccount ;
  veda-schema:lastName "System"@en ;
  veda-schema:lastName "Система"@ru ;
  rdfs:label "Veda System"@en ;
  rdfs:label "Система Веда"@ru ;
.
veda-admin:VedaSystemAccount
  rdf:type veda-schema:Account ;
  veda-schema:login "veda"^^xsd:string ;
  veda-schema:mailbox "veda@semantic-machines.com"^^xsd:string ;
  veda-schema:owner veda-schema:VedaSystem ;
  veda-schema:password "6220b3e1f255f8e29b87488abab1bde126a6bbb44c62bf9b297b3d20347f8b4e"^^xsd:string ;
  rdfs:label "Veda System Account"@en ;
  rdfs:label "Учетная запись системы Веда"@ru ;
.
veda-admin:Mandate_1
  rdf:type veda-schema:Mandate ;
  veda-schema:author veda-admin:VedaSystemAccount ;
  veda-schema:created "2014-01-31T15:28:18"^^xsd:dateTime ;
  veda-schema:published "2014-01-31T15:28:18"^^xsd:dateTime ;
  veda-schema:script """
var ticket = '';
var ff = get_property_chain (ticket, '$document', 'veda-schema:author', 'veda-schema:employee');
if (ff)
{
    var employee_uri = getUri (ff['field']);
    var first_doc = ff['first'];
    if (first_doc)
    {
	var doc_uri = first_doc['@'];	
    print ("doc_uri=" + doc_uri);
    if (employee_uri)
    {
	var new_permission = 
	{
        '@' : guid (), 
        'rdf:type' : [{data: 'veda-schema:PermissionStatement', type : 1}],
        'veda-schema:canDelete' : [{data: 'true'}],
        'veda-schema:canRead' : [{data: 'true'}],
        'veda-schema:canUpdate' : [{data: 'true'}],
        'veda-schema:permissionObject' : [{data: doc_uri, type : 1}],
        'veda-schema:permissionSubject'  : [{data: employee_uri, type : 1}]
	};
	put_individual (ticket, new_permission);
    }
    }
}
"""^^xsd:string ;
  rdfs:comment "Выдача прав авторам"@ru ;
  rdfs:label "Mandate_1"@en ;
  rdfs:label "Мандат_1"@ru ;
.
