@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix v-s: <http://semantic-machines.com/veda/veda-schema/> .
@prefix v-ui: <http://semantic-machines.com/veda/veda-ui/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix v-wf: <http://semantic-machines.com/veda/veda-workflow/> .

@prefix v-te: <http://semantic-machines.com/veda/veda-editor/> .
<http://semantic-machines.com/veda/veda-transformation-editor>
  rdf:type owl:Ontology ;
  rdfs:label "Veda transformation editor ontology"@en ;
  rdfs:label "Онтология редактора трансформаций системы Веда"@ru ;
#  owl:versionInfo "0.2" ;
  v-s:loadPriority 9 ;
.

########## TRANSFORMATION EDITOR ###########


# Function class

v-te:FunctionTransformTest
  rdf:type owl:Class ;
  rdfs:subClassOf v-s:SystemThing ;
  rdfs:label "Function Transform test"@en ;
  rdfs:label "Функция тестирование трансформации"@ru ;
  v-ui:hasTemplate v-te:FunctionTransformTestTemplate ;
.

# Function properties

v-te:testedTransform
  rdf:type owl:ObjectProperty ;
  rdfs:label "Transform"@en ;
  rdfs:label "Трансформация"@ru ;
  rdfs:domain v-te:FunctionTransformTest ;
  rdfs:range v-wf:Transform ;
.
v-te:PStestedTransform
  rdf:type v-ui:ObjectPropertySpecification ;
  rdfs:label "Спецификация свойства v-te:testedTransform"@ru ;
  rdfs:label "v-te:testedTransform property specification"@en ;
  v-ui:forClass v-te:FunctionTransformTest ;
  v-ui:forProperty v-te:testedTransform ;
  v-ui:queryPrefix "( 'rdf:type'==='v-wf:Transform' )"^^xsd:string ;
  v-ui:maxCardinality "1"^^xsd:integer ;
  v-ui:minCardinality "1"^^xsd:integer ;
.
v-te:inputIndividual
  rdf:type owl:ObjectProperty ;
  rdfs:label "Входной индивид"@ru ;
  rdfs:label "Input individual"@en ;
  rdfs:domain v-te:FunctionTransformTest ;
  rdfs:range rdfs:Resource ;
.
v-te:PSinputIndividual
  rdf:type v-ui:ObjectPropertySpecification ;
  rdfs:label "Спецификация свойства v-te:inputIndividual"@ru ;
  rdfs:label "v-te:inputIndividual property specification"@en ;
  v-ui:forClass v-te:FunctionTransformTest ;
  v-ui:forProperty v-te:inputIndividual ;
  v-ui:maxCardinality "100"^^xsd:integer ;
  v-ui:minCardinality "1"^^xsd:integer ;
.

v-te:outputIndividual
  rdf:type owl:ObjectProperty ;
  rdfs:label "Выходной индивид"@ru ;
  rdfs:label "Output individual"@en ;
  rdfs:domain v-te:FunctionTransformTest ;
  rdfs:range rdfs:Resource ;
.

v-te:PSoutputIndividual
  rdf:type v-ui:ObjectPropertySpecification ;
  rdfs:label "Спецификация свойства v-te:outputIndividual"@ru ;
  rdfs:label "v-te:outputIndividual property specification"@en ;
  v-ui:forClass v-te:FunctionTransformTest ;
  v-ui:forProperty v-te:outputIndividual ;
.

# Function individual

v-te:TransformTest
  rdf:type v-te:FunctionTransformTest ;
  rdfs:label "Тестирование трансформации"@ru ;
  rdfs:label "Transform test"@en ;
.

v-te:RunBundle
  rdf:type v-s:Bundle ;
  rdfs:label "Запустить!"@ru ;
  rdfs:label "Run!"@en ;
.

# Function template

v-te:FunctionTransformTestTemplate
  rdf:type v-ui:ClassTemplate ;
  rdfs:label "v-te:FunctionTransformTest class template"@en ;
  rdfs:label "Шаблон класса v-te:FunctionTransformTest"@ru ;
  v-ui:forClass v-te:FunctionTransformTest ;
  v-ui:template """
<div class="container sheet">
  <h3 about="@" property="rdfs:label"></h3>
  <hr>
  <div class="row">
    <div class="col-md-6">
      <em about="v-te:inputIndividual" property="rdfs:label"></em>
      <ul rel="v-te:inputIndividual">
        <li property="@"><span property="rdfs:label"></span></li>
      </ul>
      <veda-control rel="v-te:inputIndividual" data-type="link" class="fulltext dropdown"></veda-control>
      <em about="v-te:testedTransform" property="rdfs:label"></em>
      <veda-control rel="v-te:testedTransform" data-type="link" class="fulltext dropdown"></veda-control>
      <br>
      <button id="run-button" class="btn btn-success" about="v-te:RunBundle" property="rdfs:label"></button>
      <em about="v-te:outputIndividual" property="rdfs:label"></em>
      <ul rel="v-te:outputIndividual">
        <li property="@"><span property="rdfs:label"></span></li>
      </ul>
    </div>
    <div id="ttl-view" class="col-md-6"></div>
  </div>
</div>
<script>
  if ( mode!=="edit" ) {
    template.trigger("edit");
  }
  $("#run-button", template).click(function () {
    if ( !individual.hasValue("v-te:testedTransform") || !individual.hasValue("v-te:inputIndividual") ) { return; }
    var transform = individual["v-te:testedTransform"][0];
    individual["v-te:outputIndividual"] = veda.Util.applyTransform(individual["v-te:inputIndividual"], transform);
  });

  $("li", template).click(function () {
    var holder = $("#ttl-view", template).empty();
    var uri = $(this).attr("resource");
    var ind = new veda.IndividualModel( uri );
    ind.present(holder, "v-ui:ttl");
  });
  //# sourceURL=v-te:FunctionTransformTestTemplate
</script>
  """
.
